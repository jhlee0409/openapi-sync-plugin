# Elenchus Verification Criteria Framework

이 문서는 Elenchus 플러그인의 모든 검증 활동에서 사용되는 **표준화된 검증 기준**을 정의합니다.

## 왜 표준화된 기준이 필요한가?

1. **일관성**: 사용자 환경에 관계없이 동일한 품질의 검증
2. **완결성**: 빠뜨리는 검증 영역 없음
3. **재현성**: 동일 코드에 대해 동일한 이슈 도출
4. **적용성**: 도출된 이슈가 실제 수정 가능한 형태

---

## 검증 카테고리 (Verification Categories)

### Category 1: SECURITY (보안)

| ID | 항목 | 확인 방법 | 심각도 |
|----|------|----------|--------|
| SEC-01 | SQL Injection | 쿼리 파라미터 이스케이프 확인 | CRITICAL |
| SEC-02 | XSS | 사용자 입력 출력 시 이스케이프 확인 | CRITICAL |
| SEC-03 | CSRF | 상태 변경 요청에 토큰 확인 | HIGH |
| SEC-04 | 인증 우회 | 인증 체크 로직 검토 | CRITICAL |
| SEC-05 | 권한 상승 | 권한 검증 로직 검토 | CRITICAL |
| SEC-06 | 민감정보 노출 | 로그, 응답에 민감정보 포함 여부 | HIGH |
| SEC-07 | 하드코딩된 비밀 | API 키, 비밀번호 등 하드코딩 | HIGH |
| SEC-08 | 안전하지 않은 암호화 | 구식 알고리즘 사용 여부 | MEDIUM |

### Category 2: CORRECTNESS (정확성)

| ID | 항목 | 확인 방법 | 심각도 |
|----|------|----------|--------|
| COR-01 | 로직 오류 | 조건문, 루프 로직 검토 | HIGH |
| COR-02 | 경계 조건 | off-by-one, 빈 배열 등 | MEDIUM |
| COR-03 | 타입 안전성 | 타입 캐스팅, null 체크 | MEDIUM |
| COR-04 | 비동기 처리 | race condition, 순서 보장 | HIGH |
| COR-05 | 에러 핸들링 | 예외 처리 누락 | MEDIUM |
| COR-06 | 상태 관리 | 일관성 없는 상태 업데이트 | HIGH |

### Category 3: RELIABILITY (안정성)

| ID | 항목 | 확인 방법 | 심각도 |
|----|------|----------|--------|
| REL-01 | 리소스 누수 | 열린 연결, 메모리 해제 | HIGH |
| REL-02 | 재시도 로직 | 네트워크 오류 복구 | MEDIUM |
| REL-03 | 타임아웃 | 무한 대기 가능성 | MEDIUM |
| REL-04 | 우아한 종료 | 시그널 핸들링 | LOW |

### Category 4: MAINTAINABILITY (유지보수성)

| ID | 항목 | 확인 방법 | 심각도 |
|----|------|----------|--------|
| MNT-01 | 중복 코드 | DRY 원칙 위반 | LOW |
| MNT-02 | 복잡도 | 순환 복잡도 과다 | LOW |
| MNT-03 | 의존성 | 숨겨진 의존성, 순환 의존 | MEDIUM |
| MNT-04 | 명명 규칙 | 일관성 없는 명명 | LOW |

### Category 5: PERFORMANCE (성능)

| ID | 항목 | 확인 방법 | 심각도 |
|----|------|----------|--------|
| PRF-01 | N+1 쿼리 | 루프 내 쿼리 실행 | MEDIUM |
| PRF-02 | 메모리 비효율 | 불필요한 복사, 대용량 메모리 | MEDIUM |
| PRF-03 | 알고리즘 복잡도 | O(n²) 이상 경고 | LOW |
| PRF-04 | 캐싱 누락 | 반복 계산 최적화 가능 | LOW |

---

## 심각도 정의 (Severity Definitions)

| 심각도 | 정의 | 조치 요구 |
|--------|------|----------|
| **CRITICAL** | 보안 취약점, 데이터 손실 가능 | 즉시 수정 필수 |
| **HIGH** | 기능 장애, 서비스 중단 가능 | 배포 전 수정 필수 |
| **MEDIUM** | 기능 저하, 엣지케이스 버그 | 배포 전 수정 권장 |
| **LOW** | 코드 품질, 유지보수성 | 시간 있을 때 수정 |

---

## 이슈 작성 규칙 (Issue Documentation Rules)

모든 이슈는 다음 형식을 따라야 합니다:

```markdown
### [ID]: [한 줄 요약]

**카테고리**: [SECURITY/CORRECTNESS/RELIABILITY/MAINTAINABILITY/PERFORMANCE]
**심각도**: [CRITICAL/HIGH/MEDIUM/LOW]
**위치**: [파일:라인번호]

**현재 상태**:
```[언어]
[문제가 있는 코드]
```

**문제점**:
[무엇이 왜 문제인지 구체적 설명]

**증거**:
[실제 확인한 내용 - 코드, 테스트 결과, 로그 등]

**수정 방향**:
[어떻게 수정해야 하는지 구체적 방향]
```

---

## 검증 범위 결정 규칙 (Scope Determination Rules)

### 단일 파일 검증
- 해당 파일의 모든 카테고리 검증
- 직접 import하는 의존성 1레벨까지 확인

### 디렉토리 검증
- 해당 디렉토리 내 모든 파일 검증
- 파일 간 상호작용 검증 추가

### 기능 검증
- 관련 파일 식별 후 디렉토리 검증과 동일
- 통합 테스트 관점 추가

---

## 검증자 역할별 기준 (Verifier Role Guidelines)

### Elenchus-Verifier (검증자)

**책임**: 코드를 직접 읽고 이슈 도출

**필수 확인 사항**:
1. 위 5개 카테고리 전체를 순차 검토
2. 각 이슈에 증거(코드 라인, 테스트 결과) 첨부
3. 이슈 ID 부여

**금지 사항**:
- "괜찮아 보인다" (증거 없는 주장)
- 카테고리 누락
- 심각도 없는 이슈 제기

### Elenchus-Critic (비평자)

**책임**: 검증자의 분석을 검증

**필수 확인 사항**:
1. 검증자가 5개 카테고리 모두 다뤘는지
2. 각 이슈의 증거가 실제로 유효한지
3. 놓친 영역이 있는지

**수렴 조건**:
- 모든 카테고리가 증거 기반으로 검토됨
- 놓친 중요 영역 없음
- 이슈 심각도가 적절함

---

## 수렴 기준 (Convergence Criteria)

검증 루프가 종료되려면 다음 조건을 **모두** 충족해야 합니다:

### 1. 완결성 (Completeness)
- [ ] 5개 카테고리 모두 검토됨
- [ ] 대상 코드의 모든 public 함수 검토됨
- [ ] 1레벨 의존성 확인됨

### 2. 증거성 (Evidence)
- [ ] 모든 이슈에 파일:라인번호 있음
- [ ] CRITICAL/HIGH 이슈에 재현 가능한 시나리오 있음
- [ ] "괜찮다" 판정에도 확인 증거 있음

### 3. 합의성 (Agreement)
- [ ] 모든 이슈의 심각도에 양측 동의
- [ ] 미해결 쟁점은 명시적으로 "UNRESOLVED"로 표기
- [ ] 최종 판정(PASS/FAIL/CONDITIONAL)에 양측 동의

---

## 재검증 시 이슈 0 보장 조건

재검증에서 새로운 이슈가 나오지 않으려면:

### Apply 단계에서
1. 모든 CRITICAL/HIGH 이슈 수정 완료
2. 수정마다 해당 이슈 ID와 연결
3. 수정 후 해당 검증 항목 재실행

### Re-verify 단계에서
1. 이전 이슈 테이블을 입력으로 받음
2. 각 이슈별로 수정 여부 확인
3. 새 이슈는 "NEW-"로 시작하는 ID 부여
4. 이전 이슈 재발견 시 "REGRESSION-" prefix

### 종료 조건
```
재검증 결과:
- 이전 이슈: 모두 RESOLVED
- 신규 이슈: 없음
- REGRESSION: 없음

→ PASS 판정 가능
```

---

## 버전 관리

| 버전 | 날짜 | 변경 사항 |
|------|------|----------|
| 1.0.0 | 2024-01 | 초기 버전 |
